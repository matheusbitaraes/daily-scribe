# litestream.yml
# Comprehensive Litestream configuration for Daily Scribe
# Continuous SQLite replication to Google Cloud Storage with monitoring and recovery

dbs:
  - path: /app/data/digest_history.db
    replicas:
      - type: gcs
        # The name of your Google Cloud Storage bucket
        bucket: ${GCS_BUCKET}
        # Path prefix in the bucket for Daily Scribe backups
        path: daily-scribe-db
        # GCS region for the bucket
        region: ${GCS_REGION:-us-central1}
        # Sync every 10 seconds for low replication lag
        sync-interval: 10s
        # Create snapshots every hour for point-in-time recovery
        snapshot-interval: 1h
        # Retain snapshots for 30 days (720 hours)
        retention: 720h
        # Validate backup integrity every 24 hours
        validation-interval: 24h
        # Enable compression for storage efficiency
        compression: gzip

# Global Litestream settings
# Bind address for HTTP server (health checks, metrics)
addr: ":9090"

# Enable metrics collection
metrics: true

# Log level (debug, info, warn, error)
log-level: info

# Prometheus metrics endpoint for monitoring
prometheus-addr: ":9091"
